# Database Migration to Supabase

This folder contains migration files and utilities for transitioning from the Replit database to Supabase.

## Migration Steps

1. Ensure you have the correct `DATABASE_URL` environment variable set with your Supabase connection string

2. Run the database check script to verify connection:
   ```
   node -r tsx/cjs server/utils/check-db-connection.js
   ```

3. When connection is verified, run the migration script:
   ```
   npx drizzle-kit push
   ```
   OR use the SQL file directly in Supabase's SQL Editor:
   ```
   migrations/full_schema.sql
   ```

## Structure

- `full_schema.sql`: Complete SQL schema for manual execution in Supabase's SQL editor
- `migrate.js`: Node script to execute the SQL schema programmatically (requires correct DATABASE_URL)
- Other `.sql` files: Generated by drizzle-kit for incremental migrations

## Fallback Mechanism

The application uses an in-memory storage fallback when the database connection is unavailable. This ensures the application remains functional during the migration process.

This solution:
1. Keeps the app running while database migration is in progress
2. Maintains the same schema and operations interface
3. Automatically switches to the real database when connection is established
4. Provides sample data in memory for development and testing